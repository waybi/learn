<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>JavaScript设计模式</title>
	<script src="https://cdn.bootcss.com/snabbdom/0.7.1/snabbdom.js"></script>
	<script src="https://cdn.bootcss.com/snabbdom/0.7.1/snabbdom-class.js"></script>
	<script src="https://cdn.bootcss.com/snabbdom/0.7.1/snabbdom-props.js"></script>
	<script src="https://cdn.bootcss.com/snabbdom/0.7.1/snabbdom-style.js"></script>
	<script src="https://cdn.bootcss.com/snabbdom/0.7.1/snabbdom-eventlisteners.js"></script>
	<script src="https://cdn.bootcss.com/snabbdom/0.7.1/h.js"></script>
</head>
<body>
	<div id="app"></div>
	<button id="btn">点我变身</button>
	<script type="text/javascript">
		var snabbdom = window.snabbdom
		var patch = snabbdom.init({
			snabbdom_class,
			snabbdom_props,
			snabbdom_style,
			snabbdom_eventlisteners
		})
		var h = snabbdom.h
		var container = document.getElementById('app')
		var data = [
			{
				name:'张三',
				age:'29',
				address:'北京'
			},
			{
				name:'李四',
				age:'28',
				address:'广州'
			},
			{
				name:'王五',
				age:'20',
				address:'深圳'
			}
		]
		data.unshift({
			name:'年龄',
			age:'姓名',
			address:'地址'
		})

		var vnode 
		function render(data) {
			var newVnode = h('table',{},data.map(function(item,i){
				var tds = []
				var i
				for(i in item){
					// if(item.hasOwnProperty(i)){
						tds.push(item[i] + '')
					// }
				}
				tds.push(h('td',{},item[i] + ''))
				return h('tr',{},tds)
			}))
			if(vnode){
				patch(vnode,newVnode)
			}else{
				patch(container,newVnode)
			}
			vnode = newVnode
		}

		render(data)

		// var vnode = h('ul#list',{},[
		// 	h('li.item',{},'Item1'),
		// 	h('li.item',{},'Item2')
		// ])
		document.getElementById('btn').addEventListener('click',function() {
			data[1].age = 100 
			data[2].address = '香格里拉'
			render(data)
		})

		// patch(container,vnode)
	</script>
</body>
</html>